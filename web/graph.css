:root,
#app {
  --color-transparent: oklch(0% 0 0 / 0%);
  --mask-solid: oklch(0% 0 0);
  --bg-dark: oklch(15% 0.010 268);
  --bg: oklch(20% 0.010 268);
  --bg-light: oklch(25% 0.010 268);
  --panel-bg: oklch(30% 0.015 273);
  --panel-bg-raised: oklch(32.5% 0.015 273);
  --panel-bg-border: oklch(25% 0.015 273);
  --panel-bg-soft: oklch(24.5% 0.015 273);
  --panel-bg-deep: oklch(20% 0.015 273);
  --panel-bg-glass: oklch(25% 0.015 273 / 25%);
  --panel-bg-overlay: oklch(20% 0.015 273 / 50%);
  --panel-bg-fade: oklch(30% 0.015 273 / 50%);
  --chip-bg: oklch(27.5% 0.015 273);
  --chip-bg-border: oklch(25.5% 0.015 273);
  --chip-bg-border-soft: oklch(30% 0.015 273);
  --chip-bg-raised: oklch(29.5% 0.015 273);
  --chip-bg-raised-strong: oklch(32.5% 0.015 273);
  --chip-bg-raised-soft-alpha: oklch(32.5% 0.015 273 / 50%);
  --chip-bg-fade: oklch(32.5% 0.015 273 / 40%);
  --popup-bg: oklch(32.5% 0.015 273);
  --popup-bg-hover: oklch(37.5% 0.015 273 / 50%);
  --popup-border: oklch(27.5% 0.015 273);
  --btn-bg: oklch(24.5% 0.015 273);
  --btn-border: oklch(22.5% 0.015 273);
  --btn-bg-hover: oklch(26.5% 0.015 273);
  --btn-border-hover: oklch(26.5% 0.015 273);
  --accent: oklch(35.558% 0.12502 322.71);
  --accent-border: oklch(35.558% 0.12502 322.71 / 50%);
  --accent-border-soft: oklch(40.558% 0.12502 322.71 / 50%);
  --accent-border-subtle: oklch(40.558% 0.12502 322.71 / 25%);
  --accent-border-strong: oklch(10.558% 0.07502 322.71);
  --accent-bg-soft: oklch(35.558% 0.12502 322.71 / 75%);
  --accent-bg-base: oklch(35.558% 0.12502 322.71 / 50%);
  --accent-bg-muted: oklch(40.558% 0.12502 322.71 / 30%);
  --accent-bg-strong: oklch(40.558% 0.12502 322.71 / 50%);
  --accent-link-hover: oklch(60.558% 0.12502 322.71);
  --border: oklch(27.5% 0.015 273);
  --border-soft: oklch(32.5% 0.015 273);
  --border-dark: oklch(22.5% 0.015 273);
  --border-panel-deep: oklch(20% 0.015 273);
  --border-panel-raised-alpha: oklch(35% 0.015 273 / 50%);
  --border-mix-24: oklch(32.5% 0.015 273 / 76%);
  --border-mix-48: oklch(32.5% 0.015 273 / 52%);
  --border-mix-52: oklch(32.5% 0.015 273 / 48%);
  --text: oklch(90% 0 0);
  --text-muted: oklch(75% 0 0);
  --text-blend-muted: oklch(77.7% 0 0);
  --text-transparent: oklch(0% 0 0 / 0%);
  --link: oklch(80.9069% 0.095598 251.81);
  --text-size-small: 11px;
  --text-size: 13px;
  --text-size-large: 15px;
  --radius-small: 5px;
  --radius: 10px;
  --radius-large: 20px;
  --shadow: 0px 2px 1px -1px oklch(19.1251% 0 0 / 12%), 0px 1px 1px 0px oklch(19.1251% 0 0 / 6%), 0px 1px 3px 0px oklch(19.1251% 0 0 / 4%);
  --shadow-elevated: 0 12px 28px oklch(12.8802% 0.040603 264.70 / 50%);
  --overlay-backdrop: oklch(12.8802% 0.040603 264.70 / 45%);
  --overlay-backdrop-soft: oklch(12.8802% 0.040603 264.70 / 20%);
  --cloze-bg: oklch(73.1604% 0.161452 50.98 / 25%);
  --input-bg: oklch(27.5% 0.015 273);
  --input-border: oklch(25.5% 0.015 273);
  --input-bg-focus: oklch(32.5% 0.015 273);
  --input-border-focus: oklch(35.558% 0.12502 322.71 / 50%);
  --control-bg: oklch(24.5% 0.015 273);
  --control-border: oklch(22.5% 0.015 273);
  --control-bg-hover: oklch(26.5% 0.015 273);
  --control-border-hover: oklch(26.5% 0.015 273);
  --danger: oklch(85% 0.150 015);
  --warn: oklch(85% 0.150 080);
  --ok: oklch(85% 0.150 165);
  --info: oklch(85% 0.150 230);
  /* Backward-compat aliases */
  --bg-btn: oklch(24.5% 0.015 273);
  --bg-chip-100: oklch(32.5% 0.015 273 / 50%);
  --bg-chip-200: oklch(20% 0.015 273 / 50%);
}

*,
*::before,
*::after {
  box-sizing: border-box;
}

html,
body {
  width: 100%;
  height: 100%;
  margin: 0;
}

body {
  font-family: "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif;
  color: var(--text);
  background: var(--bg-dark);
}

#app {
  position: fixed;
  inset: 0;
  display: flex;
  flex-direction: column;
  min-width: 0;
  min-height: 0;
}

a {
  text-decoration: none;
  color: var(--text);
}
a:hover {
  color: var(--accent-link-hover);
}

.hidden {
  display: none !important;
}

.swatch {
  width: 10px;
  height: 10px;
  border-radius: var(--radius-small);
  border: 1px solid var(--border-soft);
}

.layer-pill {
  border-radius: var(--radius);
  border: 1px solid var(--control-border);
  background: var(--control-bg);
  color: var(--text);
  padding: 4px 10px;
  color: var(--text);
  font-size: 11px;
  box-shadow: var(--shadow);
  outline: none;
  cursor: pointer;
  user-select: none;
}
.layer-pill:hover, .layer-pill:focus {
  border: 1px solid var(--control-border-hover);
  background: var(--control-bg-hover);
}
.layer-pill.active {
  border: 1px solid var(--control-border-hover);
  background: var(--control-bg-hover);
}
.layer-pill {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  user-select: none;
}

button {
  border-radius: var(--radius);
  border: 1px solid var(--control-border);
  background: var(--control-bg);
  color: var(--text);
  padding: 8px 10px;
  color: var(--text);
  font-size: var(--text-size);
  box-shadow: var(--shadow);
  outline: none;
  cursor: pointer;
  user-select: none;
}
button:hover, button:focus {
  border: 1px solid var(--control-border-hover);
  background: var(--control-bg-hover);
}
button.active {
  border: 1px solid var(--control-border-hover);
  background: var(--control-bg-hover);
}
button {
  font-weight: 600;
}

input[type=number],
input[type=text] {
  border-radius: var(--radius-small);
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  padding: 5px 6px;
  color: var(--text);
  font-size: var(--text-size-small);
  outline: none;
  cursor: pointer;
}
input[type=number]:hover, input[type=number].active, input[type=number]:focus,
input[type=text]:hover,
input[type=text].active,
input[type=text]:focus {
  border: 1px solid var(--input-border-focus);
  outline: none;
}
input[type=number].active, input[type=number]:focus,
input[type=text].active,
input[type=text]:focus {
  background: var(--input-bg-focus);
}
input[type=number],
input[type=text] {
  width: 100%;
}

input[type=checkbox] {
  appearance: none;
  border-radius: var(--radius-small);
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  padding: 0;
  color: var(--text);
  font-size: var(--text-size-small);
  outline: none;
  cursor: pointer;
}
input[type=checkbox]:hover, input[type=checkbox].active, input[type=checkbox]:focus {
  border: 1px solid var(--input-border-focus);
  outline: none;
}
input[type=checkbox].active, input[type=checkbox]:focus {
  background: var(--input-bg-focus);
}
input[type=checkbox] {
  margin: 0;
  font: inherit;
  width: var(--text-size);
  height: var(--text-size);
  border-radius: 2px;
  display: grid;
  place-content: center;
}
input[type=checkbox]::before {
  content: "";
  width: calc(var(--text-size) * 0.6);
  height: calc(var(--text-size) * 0.6);
  border-radius: 1px;
  transform: scale(0);
  transition: 120ms transform ease-in-out;
  box-shadow: inset var(--text-size) var(--text-size) var(--accent);
}
input[type=checkbox]:checked::before {
  transform: scale(1);
}

.color-picker {
  border-radius: 9999px;
  padding: 2px;
  width: 80%;
  aspect-ratio: 1;
  border: 0;
}

input[type=color] {
  border-radius: 9999px;
  border: 1px solid var(--input-border);
  background: var(--color-transparent);
  color: var(--text);
  padding: 0px;
  color: var(--text);
  font-size: var(--text-size-small);
  outline: none;
  cursor: pointer;
}
input[type=color]:hover, input[type=color].active, input[type=color]:focus {
  border: 1px solid var(--input-border-focus);
  outline: none;
}
input[type=color].active, input[type=color]:focus {
  background: var(--color-transparent);
}
input[type=color] {
  width: 100%;
  height: 100%;
  margin-top: -2px;
  cursor: pointer;
  overflow: hidden;
}
input[type=color]:hover, input[type=color]:focus {
  border: 2px solid var(--accent);
}
input[type=color]::-webkit-color-swatch-wrapper {
  padding: 0;
  border-radius: 9999px;
  border: var(--color-transparent);
}
input[type=color]::-webkit-color-swatch {
  border: 0;
  border-radius: 9999px;
}

.select {
  border-radius: var(--radius-small);
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  padding: 5px 6px;
  color: var(--text);
  font-size: var(--text-size-small);
  outline: none;
  cursor: pointer;
}
.select:hover, .select.active, .select:focus {
  border: 1px solid var(--input-border-focus);
  outline: none;
}
.select.active, .select:focus {
  background: var(--input-bg-focus);
}
.select {
  position: relative;
  display: grid;
  grid-template-areas: "select";
  align-items: center;
  cursor: pointer;
  line-height: 1.1;
}
.select::after {
  grid-area: select;
}
.select:hover, .select.active, .select:focus {
  border: 1px solid var(--color-transparent);
}
.select:not(.select--multiple)::after {
  content: "";
  grid-area: select;
  justify-self: end;
  width: 0.8em;
  height: 0.5em;
  background: var(--accent);
  clip-path: polygon(100% 0%, 0 0%, 50% 100%);
}
.select:not(.select--multiple) option {
  border-radius: var(--radius-small);
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  padding: 5px 6px;
  color: var(--text);
  font-size: var(--text-size-small);
  outline: none;
  cursor: pointer;
}
.select:not(.select--multiple) option:hover, .select:not(.select--multiple) option.active, .select:not(.select--multiple) option:focus {
  border: 1px solid var(--input-border-focus);
  outline: none;
}
.select:not(.select--multiple) option.active, .select:not(.select--multiple) option:focus {
  background: var(--input-bg-focus);
}
.select:not(.select--multiple) option {
  display: flex;
  justify-content: flex-start;
  transition: 0.4s;
}

select::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
select::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
select::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
select::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}
select {
  appearance: none;
  background-color: var(--color-transparent);
  border: none;
  padding: 0 1em 0 0;
  margin: 0;
  width: 100%;
  font-family: inherit;
  font-size: inherit;
  cursor: inherit;
  line-height: inherit;
  outline: none;
  z-index: 1;
  color: var(--text);
  grid-area: select;
}
select::-ms-expand {
  display: none;
}
select:hover + .focus, select:focus + .focus {
  border: 1px solid var(--accent-border-soft);
  border-radius: inherit;
  position: absolute;
  top: -1px;
  left: -1px;
  right: -1px;
  bottom: -1px;
}

.select--multiple {
  padding: 0;
  outline: none;
  border: 1px solid var(--color-transparent);
}
.select--multiple:hover, .select--multiple:focus {
  border: 1px solid var(--color-transparent);
  outline: none;
}

select[multiple]::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
select[multiple]::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
select[multiple]::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
select[multiple]::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}
select[multiple] {
  border-radius: var(--radius-small);
  border: 1px solid var(--input-border);
  background: var(--color-transparent);
  color: var(--text);
  padding: 5px 6px;
  color: var(--text);
  font-size: var(--text-size-small);
  outline: none;
  cursor: pointer;
}
select[multiple]:hover, select[multiple].active, select[multiple]:focus {
  border: 1px solid var(--input-border-focus);
  outline: none;
}
select[multiple].active, select[multiple]:focus {
  background: var(--color-transparent);
}
select[multiple] {
  height: 5rem;
}
select[multiple]:hover, select[multiple]:focus {
  border: 1px solid var(--color-transparent);
  outline: none;
}
select[multiple] option {
  white-space: normal;
  padding-left: 0.5em;
  color: var(--text-muted) !important;
}
select[multiple]:not(:disabled) option {
  border-radius: 2px;
  margin-bottom: 1px;
  transition: 120ms all ease-in;
}
select[multiple]:not(:disabled) option:checked {
  background: var(--accent-bg-strong);
  padding-left: 0.5em;
  color: var(--text) !important;
}

.stack {
  display: grid;
  gap: 8px;
}

.field-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 6px;
}
.field-grid label {
  display: grid;
  gap: 4px;
  font-size: 11px;
  color: var(--text-muted);
}

.line-item {
  display: flex;
  align-items: center;
  gap: 8px;
  border: 1px solid var(--panel-bg-raised);
  border-radius: 8px;
  background: var(--panel-bg-raised);
  padding: 5px 6px;
  font-size: 12px;
}

.control-row {
  display: grid;
  grid-template-columns: 1fr minmax(66px, auto);
  gap: 8px;
  align-items: center;
  border: 1px solid var(--panel-bg-raised);
  border-radius: 8px;
  background: var(--panel-bg-raised);
  padding: 5px 6px;
  font-size: 12px;
}
.control-row label {
  color: var(--text-muted);
  font-size: 11px;
}

.chip-row {
  display: flex;
  gap: 5px;
  flex-wrap: wrap;
}

.inline-pair {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
}

.hint {
  margin: 0 0 8px 0;
  color: var(--text-muted);
  font-size: 11px;
}

@media (max-width: 1180px) {
  #toolbar {
    grid-template-columns: 1fr;
  }
  #main-layout {
    overflow: hidden;
  }
  #settings-panel {
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: min(92vw, 420px);
    z-index: 120;
    border-left: 1px solid var(--border);
  }
  #search-suggest {
    right: 0;
  }
}
#toolbar {
  display: grid;
  grid-template-columns: minmax(200px, 1.1fr) minmax(300px, 1fr) auto;
  gap: 12px;
  align-items: center;
  padding: 10px 25px;
  background: var(--panel-bg);
}

#toolbar-left,
#toolbar-center,
#toolbar-right {
  min-width: 0;
}

#toolbar-right {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
}

#btn-refresh,
#btn-ai-create {
  border-radius: var(--radius);
  border: 1px solid var(--accent);
  background: var(--accent-bg-muted);
  color: var(--text);
  padding: 8px 10px;
  color: var(--text);
  font-size: var(--text-size);
  box-shadow: var(--shadow);
  outline: none;
  cursor: pointer;
  user-select: none;
}
#btn-refresh:hover, #btn-refresh:focus,
#btn-ai-create:hover,
#btn-ai-create:focus {
  border: 1px solid var(--accent);
  background: var(--accent-bg-muted);
}
#btn-refresh.active,
#btn-ai-create.active {
  border: 1px solid var(--accent);
  background: var(--accent-bg-muted);
}

#toolbar-debug {
  display: inline-flex;
}
#toolbar-debug > * {
  border-radius: 0;
  position: relative;
}
#toolbar-debug > * + * {
  margin-left: -1px;
}
#toolbar-debug > :first-child {
  border-top-left-radius: var(--radius);
  border-bottom-left-radius: var(--radius);
}
#toolbar-debug > :last-child {
  border-top-right-radius: var(--radius);
  border-bottom-right-radius: var(--radius);
}
#toolbar-debug > :first-child:last-child {
  border-radius: var(--radius);
}
#toolbar-debug > *:hover,
#toolbar-debug > *:active {
  z-index: 1;
}
#toolbar-debug button {
  border-radius: 0;
  border: 1px solid var(--accent-border-strong);
  background: var(--accent-bg-strong);
  color: var(--text);
  padding: 8px 10px;
  color: var(--text);
  font-size: var(--text-size);
  box-shadow: var(--shadow);
  outline: none;
  cursor: pointer;
  user-select: none;
}
#toolbar-debug button:hover, #toolbar-debug button:focus {
  border: 1px solid var(--accent-border-strong);
  background: var(--accent-bg-strong);
}
#toolbar-debug button.active {
  border: 1px solid var(--accent-border-strong);
  background: var(--accent-bg-strong);
}

#search-wrap {
  position: relative;
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 0;
}
#search-wrap #search-input-wrap {
  position: relative;
  margin-right: 0;
}
#search-wrap #search-input-wrap #search-input {
  border-radius: var(--radius);
  border: 1px solid var(--chip-bg-raised-soft-alpha);
  background: var(--chip-bg-raised-soft-alpha);
  color: var(--text);
  padding: 8px 10px;
  color: var(--text);
  font-size: var(--text-size);
  box-shadow: var(--shadow);
  outline: none;
  cursor: pointer;
  user-select: none;
}
#search-wrap #search-input-wrap #search-input:hover, #search-wrap #search-input-wrap #search-input:focus {
  border: 1px solid var(--control-border-hover);
  background: var(--control-bg-hover);
}
#search-wrap #search-input-wrap #search-input.active {
  border: 1px solid var(--control-border-hover);
  background: var(--control-bg-hover);
}
#search-wrap #search-input-wrap #search-input {
  position: absolute;
  inset: 1px;
  border-bottom-right-radius: 0;
  border-top-right-radius: 0;
}
#search-wrap #search-input-wrap #search-input:hover, #search-wrap #search-input-wrap #search-input.active, #search-wrap #search-input-wrap #search-input:focus {
  border: 1px solid var(--accent-border-soft);
  background: var(--chip-bg-raised-soft-alpha);
}
#search-wrap #search-go {
  width: 50px;
  margin-left: 1px;
  border-bottom-left-radius: 0;
  border-top-left-radius: 0;
}
#search-wrap #search-suggest::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
#search-wrap #search-suggest::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
#search-wrap #search-suggest::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
#search-wrap #search-suggest::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}
#search-wrap #search-suggest {
  position: absolute;
  top: calc(100% + 0px);
  width: calc(100% - 50px);
  left: 0;
  right: 85px;
  max-height: 260px;
  overflow: auto;
  background: var(--popup-bg);
  border-radius: var(--radius);
  z-index: 500;
}
#search-wrap #search-suggest.is-visible {
  display: block;
  border: 1px solid var(--border-soft);
}
#search-wrap #search-suggest .suggest-item {
  padding: 7px 9px;
  border-bottom: 1px solid var(--border);
  cursor: pointer;
}
#search-wrap #search-suggest .suggest-item:hover, #search-wrap #search-suggest .suggest-item:active {
  background: var(--popup-bg-hover);
  border-bottom: 1px solid var(--accent);
}
#search-wrap #search-suggest .suggest-item .suggest-meta {
  display: block;
  color: var(--text-muted);
  font-size: 11px;
}

#settings-panel {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  width: min(390px, 42vw);
  min-height: 0;
  background: var(--panel-bg);
  transition: transform 180ms ease, opacity 180ms ease, visibility 180ms ease;
  z-index: 120;
  overflow: visible;
}
#settings-panel::before {
  content: "";
  position: absolute;
  left: calc(var(--radius-large) * -2);
  top: 0;
  width: calc(var(--radius-large) * 2);
  height: calc(var(--radius-large) * 2);
  background: var(--panel-bg);
  pointer-events: none;
  z-index: 121;
  mask: radial-gradient(circle calc(var(--radius-large) * 2) at 0 100%, var(--color-transparent) calc(var(--radius-large) * 2 - 0px), var(--mask-solid) calc(var(--radius-large) * 2));
}
#settings-panel.closed {
  transform: translateX(calc(100% + 16px));
  opacity: 0;
  pointer-events: none;
  visibility: hidden;
}
#settings-panel #settings-head {
  height: 12%;
  overflow: auto;
  padding: 12px 12px;
  box-sizing: border-box;
  border-bottom: 1px solid var(--panel-bg-border);
  box-shadow: var(--shadow);
}
#settings-panel #settings-head .panel-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin-bottom: 12px;
}
#settings-panel #settings-head .panel-head h2 {
  margin: 0;
  font-size: 18px;
}
#settings-panel #settings-head #settings-tabs {
  display: inline-flex;
}
#settings-panel #settings-head #settings-tabs > * {
  border-radius: 0;
  position: relative;
}
#settings-panel #settings-head #settings-tabs > * + * {
  margin-left: -1px;
}
#settings-panel #settings-head #settings-tabs > :first-child {
  border-top-left-radius: var(--radius);
  border-bottom-left-radius: var(--radius);
}
#settings-panel #settings-head #settings-tabs > :last-child {
  border-top-right-radius: var(--radius);
  border-bottom-right-radius: var(--radius);
}
#settings-panel #settings-head #settings-tabs > :first-child:last-child {
  border-radius: var(--radius);
}
#settings-panel #settings-head #settings-tabs > *:hover,
#settings-panel #settings-head #settings-tabs > *:active {
  z-index: 1;
}
#settings-panel #settings-head #settings-tabs {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 0px;
}
#settings-panel #settings-head #settings-tabsbutton {
  border-radius: 0;
  border: 1px solid var(--control-border);
  background: var(--control-bg);
  color: var(--text);
  padding: 8px 10px;
  color: var(--text);
  font-size: var(--text-size);
  box-shadow: var(--shadow);
  outline: none;
  cursor: pointer;
  user-select: none;
}
#settings-panel #settings-head #settings-tabsbutton:hover, #settings-panel #settings-head #settings-tabsbutton:focus {
  border: 1px solid var(--control-border-hover);
  background: var(--control-bg-hover);
}
#settings-panel #settings-head #settings-tabsbutton.active {
  border: 1px solid var(--control-border-hover);
  background: var(--control-bg-hover);
}
#settings-panel #settings-head #settings-tabsbutton {
  font-weight: 600;
}
#settings-panel #settings-head #settings-tabs .settings-tab.active {
  border: 1px solid var(--accent-border-subtle);
  background: var(--accent-bg-base);
}
#settings-panel #settings-head #settings-tabs .settings-tab.active:hover {
  border: 1px solid var(--accent-border-soft);
  background: var(--accent-bg-soft);
}
#settings-panel .settings-scroll::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
#settings-panel .settings-scroll::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
#settings-panel .settings-scroll::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
#settings-panel .settings-scroll::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}
#settings-panel .settings-scroll {
  height: 88%;
  min-height: 0;
  overflow: auto;
  padding: 12px 12px;
  box-sizing: border-box;
  border: none;
}
#settings-panel .settings-scroll .settings-block {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--panel-bg-soft);
  padding: 10px;
  margin-bottom: 10px;
}
#settings-panel .settings-scroll .settings-block h3 {
  margin: 0 0 8px 0;
  font-size: 14px;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--panel-bg);
  padding: 8px;
  transition: border-color 180ms ease, background-color 180ms ease;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-type-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 6px;
  transition: margin-bottom 180ms ease;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-type-head .line-item {
  border: 1px solid var(--border);
  border-radius: 8px;
  background: var(--border);
  padding: 5px 6px;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-type-head .note-type-name {
  font-size: 13px;
  font-weight: 700;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-type-body {
  display: grid;
  grid-template-rows: 1fr;
  opacity: 1;
  transition: grid-template-rows 220ms ease, opacity 220ms ease;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-type-body .note-type-body-inner {
  min-height: 0;
  overflow: hidden;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card.is-collapsed .note-type-head {
  margin-bottom: 0;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card.is-collapsed .note-type-body {
  grid-template-rows: 0fr;
  opacity: 0;
  pointer-events: none;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-field-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 1%;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-field-grid .note-fields-left {
  flex: 0 0 29%;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-field-grid .note-fields-right {
  flex: 0 0 69%;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-field-grid .note-fields-bottom {
  flex: 0 0 100%;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-field-grid .note-fields-bottom select[multiple]::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-field-grid .note-fields-bottom select[multiple]::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-field-grid .note-fields-bottom select[multiple]::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
#settings-panel .settings-scroll .settings-block #note-type-list .note-type-card .note-field-grid .note-fields-bottom select[multiple]::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}
#settings-panel .settings-scroll .settings-block #link-runtime-settings {
  display: grid;
  gap: 8px;
}
#settings-panel .settings-scroll .settings-block #link-runtime-settings #link-settings {
  display: grid;
  gap: 8px;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--panel-bg);
  padding: 8px;
  transition: border-color 180ms ease, background-color 180ms ease;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-type-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  margin-bottom: 6px;
  transition: margin-bottom 180ms ease;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-type-head .link-type-name {
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-type-head .link-type-head-right {
  display: flex;
  align-items: center;
  gap: 6px;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-type-head .ln-collapse-indicator {
  width: 14px;
  height: 14px;
  cursor: pointer;
  display: inline-grid;
  place-items: center;
  flex: 0 0 14px;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-type-head .ln-collapse-indicator::before {
  content: "";
  width: 0.8em;
  height: 0.5em;
  background: var(--accent-bg-soft);
  clip-path: polygon(100% 0%, 0 0%, 50% 100%);
  transform: rotate(90deg);
  transform-origin: 50% 50%;
  transition: transform 0.16s ease;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-type-body {
  display: grid;
  grid-template-rows: 1fr;
  opacity: 1;
  transition: grid-template-rows 220ms ease, opacity 220ms ease;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-type-body .link-type-body-inner {
  min-height: 0;
  overflow: hidden;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card.is-collapsed .link-type-head {
  margin-bottom: 0;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card.is-collapsed .link-type-body {
  grid-template-rows: 0fr;
  opacity: 0;
  pointer-events: none;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card:not(.is-collapsed) .link-type-head .ln-collapse-indicator::before {
  transform: rotate(0deg);
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 1%;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .link-fields-left {
  flex: 0 0 29%;
  display: grid;
  gap: 6px;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .link-fields-left .color-picker {
  border-radius: 0;
  width: 100%;
  height: 10px;
  aspect-ratio: none;
  border: 0;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .link-fields-left .color-picker input[type=color] {
  border-radius: 0;
  margin-top: 0;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .link-fields-left .color-picker input[type=color]::-webkit-color-swatch-wrapper,
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .link-fields-left .color-picker input[type=color]::-webkit-color-swatch {
  border-radius: 0;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .link-fields-right {
  flex: 0 0 69%;
  display: grid;
  gap: 6px;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .link-fields-bottom {
  flex: 0 0 100%;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .ln-ml-group-hubs {
  display: grid;
  gap: 6px;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .ln-ml-group-hubs .ln-ml-group-list {
  display: grid;
  gap: 4px;
}
#settings-panel .settings-scroll .settings-block #link-layer-list .link-type-card .link-field-grid .ln-ml-group-hubs .ln-ml-group-list .ln-ml-group-row {
  border: 1px solid var(--chip-bg-raised-strong);
  border-radius: 8px;
  background: var(--panel-bg);
  padding: 5px 6px;
}
#settings-panel .settings-scroll .settings-block #engine-list .control-row,
#settings-panel .settings-scroll .settings-block #solver-list .control-row,
#settings-panel .settings-scroll .settings-block #renderer-list .control-row {
  grid-template-columns: 7fr 2fr;
}
#settings-panel .settings-scroll .tab-pane {
  display: none;
}
#settings-panel .settings-scroll .tab-pane.active {
  display: block;
}

#editor-panel {
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  width: min(390px, 42vw);
  min-height: 0;
  background: var(--panel-bg);
  transition: transform 180ms ease, opacity 180ms ease, visibility 180ms ease;
  z-index: 120;
  overflow: visible;
}
#editor-panel::before {
  content: "";
  position: absolute;
  right: calc(var(--radius-large) * -1);
  top: 24px;
  width: var(--radius-large);
  height: var(--radius-large);
  background: var(--panel-bg);
  pointer-events: none;
  z-index: 121;
  mask: radial-gradient(circle var(--radius-large) at 100% 100%, var(--color-transparent) calc(var(--radius-large) - 0px), var(--mask-solid) var(--radius-large));
}
#editor-panel.closed {
  transform: translateX(calc((100% + 16px) * -1));
  opacity: 0;
  pointer-events: none;
  visibility: hidden;
}

#main-layout {
  flex: 1 1 auto;
  display: flex;
  min-width: 0;
  min-height: 0;
  position: relative;
}

#graph-panel {
  flex: 1 1 auto;
  min-width: 0;
  min-height: 0;
  position: relative;
  background: var(--bg-dark);
  overflow: hidden;
  isolation: isolate;
}

#graph-panel.focus-mode::after {
  opacity: 1;
}

#graph {
  position: absolute;
  inset: 0;
  z-index: 2;
  overflow: hidden;
}

#gl-bench {
  top: 50px;
}

#flow-canvas {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 3;
}

#graph-empty {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  color: var(--text-muted);
  font-size: 14px;
  padding: 8px 14px;
  background: var(--bg);
  border: 1px solid var(--border-dark);
  border-radius: 999px;
  z-index: 4;
}

/* Hover Tooltip */
#hover-tip {
  position: fixed;
  border-radius: var(--radius);
  border: 1px solid var(--border-panel-deep);
  background: var(--panel-bg-glass);
  backdrop-filter: blur(8px);
  padding: 8px 10px;
  color: var(--text);
  font-size: 12px;
  box-shadow: var(--shadow);
  z-index: 500;
  pointer-events: none;
  min-width: 180px;
  max-width: 340px;
  display: none;
  line-height: 1.35;
}
#hover-tip.is-visible {
  display: block;
}
#hover-tip .tip-title {
  font-weight: 700;
  margin-bottom: 4px;
}
#hover-tip .tip-muted {
  color: var(--text-muted);
}

/* Conteext Menu */
#ctx-menu {
  position: fixed;
  border-radius: var(--radius);
  border: 1px solid var(--border-panel-deep);
  background: var(--panel-bg-glass);
  backdrop-filter: blur(8px);
  padding: 6px;
  color: var(--text);
  font-size: 12px;
  box-shadow: var(--shadow);
  z-index: 500;
  display: none;
  min-width: 220px;
  max-width: 360px;
}
#ctx-menu.is-visible {
  display: block;
}
#ctx-menu .item {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 7px 9px;
  border-radius: 8px;
  cursor: pointer;
  color: var(--text);
  border-bottom: 1px solid var(--color-transparent);
}
#ctx-menu .item:hover {
  background: var(--popup-bg-hover);
  border-bottom: 1px solid var(--accent);
}
#ctx-menu .divider {
  height: 1px;
  margin: 5px 4px;
  background: var(--panel-bg-deep);
}
#ctx-menu .ctx-icon-placeholder, #ctx-menu .ctx-icon-base {
  display: inline-block;
  width: 14px;
  height: 14px;
  min-width: 14px;
  min-height: 14px;
  flex: 0 0 14px;
  vertical-align: middle;
}
#ctx-menu .ctx-icon-base {
  --ctx-icon-primary: var(--text);
  --ctx-icon-secondary: var(--text);
  --ctx-icon-family: var(--ctx-icon-primary);
  overflow: visible;
  color: var(--ctx-icon-primary);
}
#ctx-menu .ctx-icon-base path, #ctx-menu .ctx-icon-base line, #ctx-menu .ctx-icon-base polyline, #ctx-menu .ctx-icon-base polygon, #ctx-menu .ctx-icon-base circle, #ctx-menu .ctx-icon-base ellipse, #ctx-menu .ctx-icon-base rect {
  fill: none !important;
  stroke: currentColor !important;
  stroke-linecap: round;
  stroke-linejoin: round;
  vector-effect: non-scaling-stroke;
}
#ctx-menu .ctx-icon-base .ctx-icon-path-primary {
  stroke: var(--ctx-icon-primary) !important;
  fill: var(--ctx-icon-primary) !important;
}
#ctx-menu .ctx-icon-base .ctx-icon-path-secondary {
  stroke: var(--ctx-icon-secondary, var(--ctx-icon-primary)) !important;
  fill: var(--ctx-icon-secondary, var(--ctx-icon-primary)) !important;
}
#ctx-menu .ctx-icon-base .ctx-icon-path-family {
  stroke: var(--ctx-icon-family, var(--ctx-icon-primary)) !important;
  fill: var(--ctx-icon-family, var(--ctx-icon-primary)) !important;
}
#ctx-menu .ctx-icon-base .ctx-icon-path-primary[fill=none], #ctx-menu .ctx-icon-base .ctx-icon-path-secondary[fill=none], #ctx-menu .ctx-icon-base .ctx-icon-path-family[fill=none] {
  fill: none !important;
}

#ctx-picker {
  position: fixed;
  inset: 0;
  z-index: 130;
  background: var(--overlay-backdrop);
  display: flex;
  align-items: center;
  justify-content: center;
}
#ctx-picker .dialog {
  width: min(360px, 92vw);
  max-height: min(72vh, 520px);
  border-radius: 14px;
  border: 1px solid var(--border-soft);
  background: var(--panel-bg-glass);
  box-shadow: var(--shadow-elevated);
  color: var(--text);
  display: grid;
  grid-template-rows: auto 1fr auto;
}
#ctx-picker .title {
  padding: 12px 14px 8px 14px;
  font-size: 13px;
  font-weight: 700;
}
#ctx-picker .list {
  overflow: auto;
  padding: 0 14px 10px 14px;
}
#ctx-picker .row {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 2px;
}
#ctx-picker .btn-row {
  display: flex;
  gap: 8px;
  padding: 10px 12px 12px 12px;
  border-top: 1px solid var(--border-soft);
}
#ctx-picker .btn {
  flex: 1 1 auto;
  border-radius: 9px;
  border: 1px solid var(--border-soft);
  background: var(--panel-bg-glass);
  color: var(--text);
  padding: 7px 10px;
  cursor: pointer;
}
#ctx-picker .btn:hover {
  background: var(--popup-bg-hover);
}
#ctx-picker .btn.primary {
  border-color: var(--border-dark);
}

/* Overlays */
/* Top Left Status Overlay */
/* Status Bar | Active Node Panel | Debug Panel */
#status-overlay-top-left {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 100;
  width: min(400px, 21vw);
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding-left: 10px;
  transition: transform 180ms ease;
}
#status-overlay-top-left.sidepanel {
  transform: translateX(min(390px, 42vw));
  pointer-events: none;
}
#status-overlay-top-left #statusbar {
  position: relative;
  left: -10px;
  width: calc(100% + 11px);
  height: minmax(24px, 72px);
  display: flex;
  justify-content: space-between;
  gap: 10px;
  overflow: visible;
  padding: 0px 20px 10px 25px;
  background: var(--panel-bg);
  border-bottom-right-radius: 10px;
  color: var(--text-muted);
  font-size: 12px;
}
#status-overlay-top-left #statusbar::after {
  content: "";
  position: absolute;
  right: calc(var(--radius) * -1);
  box-sizing: border-box;
  width: var(--radius);
  height: var(--radius);
  background: var(--panel-bg);
  pointer-events: none;
  mask: radial-gradient(circle at 100% 100%, var(--color-transparent) calc(var(--radius) - 0px), var(--mask-solid) var(--radius));
}
#status-overlay-top-left #status-active {
  position: relative;
  border-radius: var(--radius);
  border: 1px solid var(--border-panel-deep);
  background: var(--panel-bg-glass);
  backdrop-filter: blur(8px);
  padding: 2px 12px 12px 12px;
  color: var(--text);
  font-size: 12px;
  box-shadow: var(--shadow);
  z-index: 500;
  position: relative;
  width: 100%;
  transform: translateX(calc(-100% - 18px));
  pointer-events: none;
  transition: transform 220ms ease;
  will-change: transform;
}
#status-overlay-top-left #status-active.is-open {
  transform: translateX(0);
  pointer-events: auto;
}
#status-overlay-top-left #status-active .title h2 {
  margin-bottom: 2px;
}
#status-overlay-top-left #status-active .title h3 {
  margin-bottom: 0;
}
#status-overlay-top-left #status-active #status-active-details {
  display: block;
  white-space: normal;
  line-height: 1.35;
  color: var(--text);
  font-size: 12px;
  z-index: 100;
}
#status-overlay-top-left #status-active #status-active-cards {
  margin-top: 10px;
}
#status-overlay-top-left #status-active #status-active-cards .active-cards-table {
  border-radius: 7px;
  overflow: hidden;
}
#status-overlay-top-left #status-active #status-active-cards .active-cards-head,
#status-overlay-top-left #status-active #status-active-cards .active-card-row {
  display: grid;
  grid-template-columns: minmax(0, 1fr) 92px 84px;
  gap: 10px;
  align-items: center;
}
#status-overlay-top-left #status-active #status-active-cards .active-cards-head {
  padding: 6px 8px;
  border-bottom: 1px solid var(--border-panel-deep);
}
#status-overlay-top-left #status-active #status-active-cards .active-card-col {
  font-size: 10px;
  line-height: 1.2;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: var(--text-muted);
  font-weight: 700;
}
#status-overlay-top-left #status-active #status-active-cards .active-cards-list::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
#status-overlay-top-left #status-active #status-active-cards .active-cards-list::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
#status-overlay-top-left #status-active #status-active-cards .active-cards-list::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
#status-overlay-top-left #status-active #status-active-cards .active-cards-list::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}
#status-overlay-top-left #status-active #status-active-cards .active-cards-list {
  display: block;
  max-height: 180px;
  overflow: auto;
}
#status-overlay-top-left #status-active #status-active-cards .active-card-row {
  padding: 6px 8px;
  border-bottom: 1px solid var(--border-panel-deep);
  font-size: 11px;
  color: var(--text);
}
#status-overlay-top-left #status-active #status-active-cards .active-card-row:last-child {
  border-bottom: none;
}
#status-overlay-top-left #status-active #status-active-cards .active-card-cell {
  min-width: 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
#status-overlay-top-left #status-active #status-active-cards .active-card-status,
#status-overlay-top-left #status-active #status-active-cards .active-card-stability,
#status-overlay-top-left #status-active #status-active-cards .active-card-col-status,
#status-overlay-top-left #status-active #status-active-cards .active-card-col-stability {
  text-align: right;
  justify-self: end;
}
#status-overlay-top-left #status-active #status-active-deptree {
  display: block;
  margin: 18px 0;
  border-top: 1px solid var(--border-panel-deep);
  border-bottom: 1px solid var(--border-panel-deep);
  white-space: normal;
  line-height: 1.35;
  color: var(--text-muted);
  font-size: 11px;
}
#status-overlay-top-left #status-active #status-active-deptree .dep-tree-canvas {
  width: 100%;
  display: block;
  background: var(--color-transparent);
  cursor: pointer;
}
#status-overlay-top-left #status-active .btn-row {
  position: flex;
  align-items: end;
}
#status-overlay-top-left #status-active .btn-row #btn-editor {
  margin: 5px;
}

/* Bottom Right Status Overlay */
/* Zoom */
#status-overlay-bottom-right {
  position: absolute;
  bottom: 0;
  right: 0;
  z-index: 250;
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding-right: 10px;
  padding-bottom: 10px;
  transition: transform 180ms ease;
}
#status-overlay-bottom-right.sidepanel {
  transform: translateX(calc(min(390px, 42vw) * -1));
  pointer-events: none;
}
#status-overlay-bottom-right #status-zoom-pill {
  position: relative;
  border-radius: var(--radius);
  border: 1px solid var(--border-panel-deep);
  background: var(--panel-bg-glass);
  backdrop-filter: blur(8px);
  padding: 7px 12px;
  color: var(--text);
  font-size: 12px;
  box-shadow: var(--shadow);
  z-index: 500;
  width: fit-content;
  align-self: flex-end;
  bottom: 0;
}
#status-overlay-bottom-right #status-debug-panel {
  position: relative;
  border-radius: var(--radius);
  border: 1px solid var(--border-panel-deep);
  background: var(--panel-bg-glass);
  backdrop-filter: blur(8px);
  padding: 7px 12px;
  color: var(--text);
  font-size: 12px;
  box-shadow: var(--shadow);
  z-index: 500;
  z-index: 500;
  width: 250px;
  height: fit-content;
  align-self: flex-end;
  display: flex;
  flex-direction: column;
  gap: 5px;
}
#status-overlay-bottom-right #status-debug-panel.is-hidden {
  display: none;
}
#status-overlay-bottom-right #status-debug-panel .title {
  margin-bottom: 10px;
}
#status-overlay-bottom-right #status-debug-panel .coord-table {
  width: 100%;
  display: grid;
  grid-template-columns: 52px 1fr 1fr;
  font-size: 11px;
  gap: 0;
}
#status-overlay-bottom-right #status-debug-panel .coord-table .coord-key,
#status-overlay-bottom-right #status-debug-panel .coord-table .coord-val {
  padding: 2px 4px;
  border-top: 1px solid var(--border-soft);
}
#status-overlay-bottom-right #status-debug-panel .coord-table .coord-key {
  text-align: left;
  font-weight: 600;
  color: var(--text-muted);
}
#status-overlay-bottom-right #status-debug-panel .coord-table .coord-val {
  text-align: right;
  color: var(--text);
}
#status-overlay-bottom-right #status-debug-panel .coord-table .coord-empty {
  color: var(--text-transparent);
}

/* AI create/enrich dialog shells (markup only, no runtime wiring yet) */
#ctx-menu .ctx-item-ai-enrich {
  font-weight: 600;
}

.graph-ai-dialog {
  position: fixed;
  inset: 0;
  z-index: 420;
  display: grid;
  place-items: center;
  pointer-events: auto;
}
.graph-ai-dialog.is-hidden {
  display: none;
}
.graph-ai-dialog .graph-ai-dialog__backdrop {
  position: absolute;
  inset: 0;
  background: var(--overlay-backdrop-soft);
}
.graph-ai-dialog .graph-ai-dialog__window {
  position: relative;
  border-radius: var(--radius);
  border: 1px solid var(--border-panel-deep);
  background: var(--panel-bg-glass);
  backdrop-filter: blur(8px);
  padding: 2px 12px 12px 12px;
  color: var(--text);
  font-size: 12px;
  box-shadow: var(--shadow);
  z-index: 500;
  position: relative;
  width: min(1240px, 94vw);
  max-height: min(90vh, 980px);
  display: grid;
  grid-template-rows: auto 1fr;
  overflow: hidden;
}
.graph-ai-dialog .graph-ai-dialog__window--enrich {
  width: min(980px, 92vw);
}
.graph-ai-dialog .graph-ai-dialog__window--duplicate {
  width: min(1040px, 94vw);
}
.graph-ai-dialog .graph-ai-dialog__window--small {
  width: min(640px, 90vw);
}
.graph-ai-dialog .graph-ai-dialog__head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 12px 16px;
  border-bottom: 1px solid var(--border-soft);
}
.graph-ai-dialog .graph-ai-dialog__head h2 {
  margin: 0;
  font-size: 16px;
  font-weight: 700;
  color: var(--text);
}
.graph-ai-dialog .graph-ai-dialog__content {
  display: grid;
  grid-auto-rows: min-content;
  gap: 10px;
  padding: 14px 16px 16px 16px;
  overflow: auto;
}
.graph-ai-dialog .graph-ai-dialog__content::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
.graph-ai-dialog .graph-ai-dialog__content::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
.graph-ai-dialog .graph-ai-dialog__content::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
.graph-ai-dialog .graph-ai-dialog__content::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

.graph-ai-block {
  border: 1px solid var(--border-panel-deep);
  border-radius: 12px;
  background: var(--panel-bg-deep);
  padding: 10px 12px;
}
.graph-ai-block h3 {
  margin: 0 0 8px 0;
  font-size: 13px;
  color: var(--text);
}

.graph-ai-form-row {
  display: grid;
  grid-template-columns: 80px 1fr;
  align-items: center;
  gap: 10px;
  margin-bottom: 8px;
}
.graph-ai-form-row label {
  color: var(--text-muted);
  font-size: 12px;
  font-weight: 600;
}
.graph-ai-form-row select, .graph-ai-form-row input, .graph-ai-form-row textarea {
  width: 100%;
  border-radius: 8px;
  border: 1px solid var(--border-soft);
  background: var(--chip-bg-raised-soft-alpha);
  color: var(--text);
  padding: 7px 9px;
  font: inherit;
}
.graph-ai-form-row textarea {
  resize: vertical;
  min-height: 70px;
}

.graph-ai-form-row--column {
  grid-template-columns: 1fr;
}

.graph-ai-actions {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.graph-ai-actions--dialog {
  justify-content: flex-end;
}

.graph-ai-actions--enrich {
  margin-top: 6px;
}

.graph-ai-btn {
  border-radius: var(--radius);
  border: 1px solid var(--accent);
  background: var(--accent-bg-muted);
  color: var(--text);
  padding: 6px 10px;
  color: var(--text);
  font-size: var(--text-size);
  box-shadow: var(--shadow);
  outline: none;
  cursor: pointer;
  user-select: none;
}
.graph-ai-btn:hover, .graph-ai-btn:focus {
  border: 1px solid var(--accent);
  background: var(--accent-bg-muted);
}
.graph-ai-btn.active {
  border: 1px solid var(--accent);
  background: var(--accent-bg-muted);
}

.graph-ai-btn--ghost {
  background: var(--color-transparent);
}

.graph-ai-nav {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  padding: 3px 2px;
}
.graph-ai-nav .graph-ai-nav__left, .graph-ai-nav .graph-ai-nav__right {
  display: flex;
  align-items: center;
  gap: 8px;
}
.graph-ai-nav label, .graph-ai-nav span {
  color: var(--text-muted);
  font-size: 12px;
}
.graph-ai-nav select {
  border-radius: 8px;
  border: 1px solid var(--border-soft);
  background: var(--panel-bg-overlay);
  color: var(--text);
  padding: 6px 8px;
}

.graph-ai-perf {
  margin: 0;
  color: var(--text-blend-muted);
  font-size: 12px;
}

.graph-ai-create-layout {
  display: grid;
  grid-template-columns: minmax(220px, 0.65fr) minmax(380px, 1fr) minmax(200px, 0.6fr);
  gap: 10px;
  min-height: 360px;
}

.graph-ai-enrich-layout {
  min-height: 340px;
}

.graph-ai-pane {
  border: 1px solid var(--border-panel-deep);
  border-radius: 12px;
  background: var(--panel-bg-overlay);
  padding: 10px;
  min-height: 0;
  display: flex;
  flex-direction: column;
}
.graph-ai-pane h4 {
  margin: 0 0 8px 0;
  font-size: 12px;
  color: var(--text);
}

.graph-ai-list {
  margin: 0;
  padding: 0;
  list-style: none;
  border: 1px solid var(--border-panel-raised-alpha);
  border-radius: 8px;
  background: var(--panel-bg-overlay);
  min-height: 190px;
  overflow: auto;
}
.graph-ai-list::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
.graph-ai-list::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
.graph-ai-list::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
.graph-ai-list::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}

.graph-ai-list li {
  padding: 6px 8px;
  border-bottom: 1px solid var(--border-panel-raised-alpha);
  color: var(--text);
  font-size: 12px;
}

.graph-ai-list li:last-child {
  border-bottom: none;
}

.graph-ai-preview-box {
  border: 1px solid var(--border-mix-24);
  border-radius: 8px;
  background: var(--chip-bg-fade);
  min-height: 250px;
  overflow: auto;
}
.graph-ai-preview-box::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
.graph-ai-preview-box::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
.graph-ai-preview-box::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
.graph-ai-preview-box::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}
.graph-ai-preview-box pre {
  margin: 0;
  padding: 10px;
  color: var(--text);
  font-size: 12px;
  line-height: 1.38;
  white-space: pre-wrap;
}

.graph-ai-field-table {
  width: 100%;
  border-collapse: collapse;
}
.graph-ai-field-table th, .graph-ai-field-table td {
  border-bottom: 1px solid var(--border-mix-48);
  padding: 6px 8px;
  font-size: 12px;
  color: var(--text);
  text-align: left;
  vertical-align: top;
}
.graph-ai-field-table th {
  color: var(--text-muted);
  text-transform: uppercase;
  font-size: 10px;
  letter-spacing: 0.04em;
}

.graph-ai-template-tabs {
  display: flex;
  gap: 8px;
  padding: 10px;
  border-bottom: 1px solid var(--border-mix-52);
}

.graph-ai-template-canvas {
  min-height: 230px;
  padding: 10px;
  color: var(--text-muted);
  font-size: 12px;
}

.graph-ai-compare {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.graph-ai-note {
  margin: 0;
  color: var(--text-muted);
  font-size: 12px;
}

#editor-anki html,
#editor-anki body {
  background: var(--panel-bg) !important;
  color: var(--text) !important;
  margin: 0 !important;
  padding: 0 !important;
}
#editor-anki body {
  font-family: "Bahnschrift", "Trebuchet MS", "Segoe UI", sans-serif !important;
}
#editor-anki a {
  color: var(--link) !important;
}
#editor-anki .editing-area,
#editor-anki .label-container {
  background: var(--color-transparent) !important;
}
#editor-anki button {
  border-radius: var(--radius) !important;
  border: 1px solid var(--btn-border) !important;
  background: var(--btn-bg) !important;
  color: var(--text) !important;
  padding: 8px 10px;
  font-size: 13px;
  box-shadow: var(--shadow) !important;
  cursor: pointer;
  font-weight: 600;
}
#editor-anki button:hover, #editor-anki button:active, #editor-anki button:focus-visible {
  border: 1px solid var(--btn-border-hover) !important;
  background: var(--btn-bg-hover) !important;
}
#editor-anki .field-state .ajt-play-icon {
  padding-right: 22px;
}
#editor-anki .collapse-label {
  position: relative !important;
  display: grid !important;
  grid-template-areas: "select" !important;
  align-items: center !important;
  width: 100%;
}
#editor-anki .collapse-label .collapse-badge {
  display: none !important;
}
#editor-anki .collapse-label .label-name {
  color: var(--text-muted);
  font-size: 11px !important;
  margin-left: 5px !important;
  grid-area: select;
}
#editor-anki .collapse-label::after {
  content: "";
  grid-area: select;
  justify-self: end;
  width: 0.8em;
  height: 0.5em;
  background: var(--accent-bg-soft);
  clip-path: polygon(100% 0%, 0 0%, 50% 100%);
  transition: transform 0.16s ease;
}
#editor-anki .collapse-label[aria-expanded=false]::after {
  transform: rotate(90deg);
  transform-origin: 50% 50%;
}
#editor-anki .cloze,
#editor-anki mark {
  background: var(--cloze-bg) !important;
  color: var(--text) !important;
}
#editor-anki .hidden {
  display: none !important;
}
#editor-anki #ajpc-graph-editor-web-controls {
  display: flex;
  justify-content: flex-start;
  gap: 8px;
  padding: 12px 8px 12px 20px;
  height: 59px;
  box-sizing: border-box;
}
#editor-anki #ajpc-graph-editor-web-controls #ajpc-toolbar-debug {
  display: flex;
  gap: 0px;
}
#editor-anki #ajpc-graph-editor-web-controls #ajpc-toolbar-debug #ajpc-graph-editor-devtools,
#editor-anki #ajpc-graph-editor-web-controls #ajpc-toolbar-debug #ajpc-graph-editor-css-reload {
  border-color: var(--accent-border) !important;
  background: var(--accent-bg-soft) !important;
  box-shadow: var(--shadow) !important;
}
#editor-anki #ajpc-graph-editor-web-controls #ajpc-toolbar-debug #ajpc-graph-editor-devtools:hover, #editor-anki #ajpc-graph-editor-web-controls #ajpc-toolbar-debug #ajpc-graph-editor-devtools:active,
#editor-anki #ajpc-graph-editor-web-controls #ajpc-toolbar-debug #ajpc-graph-editor-css-reload:hover,
#editor-anki #ajpc-graph-editor-web-controls #ajpc-toolbar-debug #ajpc-graph-editor-css-reload:active {
  border-color: var(--accent-border) !important;
  background: var(--accent-bg-soft) !important;
}
#editor-anki #ajpc-graph-editor-web-controls #ajpc-toolbar-debug #ajpc-graph-editor-devtools {
  margin-right: 0;
  border-bottom-right-radius: 0 !important;
  border-top-right-radius: 0 !important;
  border-right: none !important;
}
#editor-anki #ajpc-graph-editor-web-controls #ajpc-toolbar-debug #ajpc-graph-editor-css-reload {
  margin-left: 0;
  border-bottom-left-radius: 0 !important;
  border-top-left-radius: 0 !important;
}
#editor-anki .note-editor {
  height: calc(100% - 59px) !important;
}
#editor-anki .note-editor .editor-toolbar {
  background: var(--panel-bg) !important;
  border-color: var(--border-soft) !important;
  margin: 0 !important;
  padding: 3px 10px 3px 20px !important;
}
#editor-anki .note-editor .editor-toolbar [data-command=_ajpc_browser_graph_toggle_prio],
#editor-anki .note-editor .editor-toolbar [data-command=_ajpc_browser_graph_toggle_graph],
#editor-anki .note-editor .editor-toolbar [data-command=_ajpc_browser_graph_toggle],
#editor-anki .note-editor .editor-toolbar [data-command=ajpc_ai_enrich_all],
#editor-anki .note-editor .editor-toolbar [data-command=ajpc_ai_enrich_mnemonic],
#editor-anki .note-editor .editor-toolbar [data-command=ajpc_ai_enrich_sent] {
  display: none !important;
}
#editor-anki .note-editor .editor-toolbar .button-group button {
  border-radius: 0 !important;
  padding: 1px 3px !important;
  font-size: 12px !important;
}
#editor-anki .note-editor .editor-toolbar .button-group button:hover, #editor-anki .note-editor .editor-toolbar .button-group button:active, #editor-anki .note-editor .editor-toolbar .button-group button:focus-visible {
  background: var(--accent-bg-soft) !important;
}
#editor-anki .note-editor .editor-toolbar .button-group button.ajpc-edge-first {
  border-top-left-radius: var(--radius-small) !important;
  border-bottom-left-radius: var(--radius-small) !important;
}
#editor-anki .note-editor .editor-toolbar .button-group button.ajpc-edge-last {
  border-top-right-radius: var(--radius-small) !important;
  border-bottom-right-radius: var(--radius-small) !important;
}
#editor-anki .note-editor .scroll-area-relative .scroll-area-wrapper .scroll-area::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
#editor-anki .note-editor .scroll-area-relative .scroll-area-wrapper .scroll-area::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
#editor-anki .note-editor .scroll-area-relative .scroll-area-wrapper .scroll-area::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
#editor-anki .note-editor .scroll-area-relative .scroll-area-wrapper .scroll-area::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}
#editor-anki .note-editor .scroll-area-relative .scroll-area-wrapper .scroll-area {
  direction: rtl;
  padding: 0 10px 10px 10px;
  left: 0;
}
#editor-anki .note-editor .scroll-area-relative .scroll-area-wrapper .scroll-area .d-flex {
  direction: ltr;
}
#editor-anki .note-editor .fields {
  border: 1px solid var(--border-soft) !important;
  border-radius: var(--radius) !important;
  background: var(--panel-bg-fade) !important;
  padding: 10px !important;
}
#editor-anki .note-editor .fields .collapsible {
  padding: 0px !important;
}
#editor-anki .note-editor .fields .field-container {
  display: grid;
  grid-template-columns: 1fr;
  gap: 0px;
  align-items: center;
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--panel-bg-soft);
  padding: 5px 6px;
  font-size: 12px;
}
#editor-anki .note-editor .fields .field-container .label-container {
  background: var(--color-transparent);
}
#editor-anki .note-editor .fields .field-container .label-container .collapse-badge {
  display: none !important;
}
#editor-anki .note-editor .fields .field-container .label-container .label-name {
  margin-bottom: 4px;
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field {
  border: none !important;
  box-shadow: none !important;
  outline: none;
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area {
  background: var(--chip-bg);
  border: 1px solid var(--chip-bg-border-soft);
  border-radius: var(--radius);
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area:hover, #editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area:active, #editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area:focus, #editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area:focus-visible {
  border: 1px solid var(--accent-border);
  outline: none;
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area .CodeMirror-gutters {
  background-color: var(--color-transparent);
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area > .collapsible.full-hide:not(.hidden) > .plain-text-input > .code-mirror > .CodeMirror {
  border-radius: var(--radius);
  background: var(--chip-bg);
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area > .collapsible.full-hide:not(.hidden) > .rich-text-input {
  border-radius: var(--radius);
  background: var(--chip-bg-raised);
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area.ajpc-pair-plain-rich > .collapsible.full-hide:not(.hidden) > .plain-text-input > .code-mirror > .CodeMirror {
  border-bottom-left-radius: 0 !important;
  border-bottom-right-radius: 0 !important;
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area.ajpc-pair-plain-rich > .collapsible.full-hide:not(.hidden) + .collapsible.full-hide:not(.hidden) > .rich-text-input {
  border-top-left-radius: 0 !important;
  border-top-right-radius: 0 !important;
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area.ajpc-pair-rich-plain > .collapsible.full-hide:not(.hidden) > .rich-text-input {
  border-bottom-left-radius: 0 !important;
  border-bottom-right-radius: 0 !important;
}
#editor-anki .note-editor .fields .field-container .collapsible .editor-field .editing-area.ajpc-pair-rich-plain > .collapsible.full-hide:not(.hidden) + .collapsible.full-hide:not(.hidden) > .plain-text-input > .code-mirror > .CodeMirror {
  border-top-left-radius: 0 !important;
  border-top-right-radius: 0 !important;
}
#editor-anki #ajpc-tag-wrapper {
  padding: 5px 20px !important;
}
#editor-anki #ajpc-tag-wrapper .collapsible {
  background: var(--color-transparent) !important;
  border: none !important;
  color: var(--text-muted);
  font-size: 12px !important;
}
#editor-anki #ajpc-tag-wrapper .collapsible .tag-editor {
  background: var(--chip-bg) !important;
  border-radius: var(--radius) !important;
  border: 1px solid var(--border-soft) !important;
  padding: 5px 6px !important;
  margin: 0 0 10px 0 !important;
  color: var(--text) !important;
  font-size: 12px !important;
  font-weight: 400 !important;
}
#editor-anki #ajpc-tag-wrapper .collapsible .tag-editor .tag {
  background: var(--panel-bg) !important;
  color: var(--text) !important;
  border: 1px solid var(--panel-bg-border) !important;
  padding: 0px 3px 0px 3px;
  font-size: 12px !important;
  border-radius: var(--radius) !important;
  box-shadow: none !important;
  cursor: pointer;
}
#editor-anki #ajpc-tag-wrapper .collapsible .tag-editor .tag:hover, #editor-anki #ajpc-tag-wrapper .collapsible .tag-editor .tag:active, #editor-anki #ajpc-tag-wrapper .collapsible .tag-editor .tag:focus-visible {
  background: var(--btn-bg-hover) !important;
}
#editor-anki .floating {
  border-radius: var(--radius);
}
#editor-anki .floating .popover {
  padding: 0 !important;
  border: 1px solid var(--popup-border) !important;
  background: var(--popup-bg) !important;
  color: var(--text) !important;
  border-radius: var(--radius);
}
#editor-anki .floating .popover .autocomplete-menu::-webkit-scrollbar {
  width: 10px !important;
  background: var(--color-transparent) !important;
  margin: var(--radius) 0 !important;
}
#editor-anki .floating .popover .autocomplete-menu::-webkit-scrollbar-track {
  background: var(--color-transparent) !important;
  border-radius: 999px !important;
}
#editor-anki .floating .popover .autocomplete-menu::-webkit-scrollbar-thumb {
  background: var(--accent-border-soft) !important;
  border-radius: 999px !important;
}
#editor-anki .floating .popover .autocomplete-menu::-webkit-scrollbar-button {
  display: none !important;
  width: 0 !important;
  height: 0 !important;
}
#editor-anki .floating .popover .autocomplete-menu {
  border-radius: var(--radius);
}
#editor-anki .floating .popover .autocomplete-menu .autocomplete-item {
  border: none !important;
  border-bottom: 1px solid var(--popup-border) !important;
  padding: 7px 9px;
}
#editor-anki .floating .popover .autocomplete-menu .autocomplete-item:hover {
  background: var(--chip-bg-raised-soft-alpha) !important;
  border: none !important;
  border-bottom: 1px solid var(--accent-bg-soft) !important;
}
#editor-anki .floating .popover .autocomplete-menu .autocomplete-item.selected {
  background: var(--accent-bg-soft) !important;
  border: none !important;
  border-bottom: 1px solid var(--accent-bg-soft) !important;
}
#editor-anki .floating .floating-arrow .arrow {
  background: var(--popup-bg) !important;
}
#editor-anki .tooltip .tooltip-arrow,
#editor-anki .tooltip .tooltip-inner {
  border: 1px solid var(--popup-border) !important;
  background: var(--popup-bg) !important;
  color: var(--text) !important;
}
